

data:
  path: "/sps/lsst/groups/transients/HSC/fouchez/raphael/data/rc2_norm"
  visits: null
  test_size: 0.2
  val_size: 0.1
  cutout_types: ['diff']  # Single channel input

training:
  trainer_type: "stochastic_coteaching"
  epochs: 1500
  learning_rate: 0.001
  batch_size: 128
  num_iter_per_epoch: 400
  epoch_decay_start: 80
  num_workers: 4
  weight_decay: 0
  output_dir: "/sps/lsst/groups/transients/HSC/fouchez/raphael/training/stochastic_coteaching_test"
  
  # Stochastic co-teaching specific parameters
  alpha: 32                             # Beta distribution alpha 
  beta: 4                               # Beta distribution beta 
  num_gradual: 10                       # Gradual warmup period (tp_gradual)
  delay: 0                              # Delay before starting rejection 
  exponent: 1                           # Exponent for schedule
  clip: [0.01, 0.99]                    # Min/max clipping for random thresholds
  seed: 42
  
  use_tensorboard: true
  tensorboard_log_dir: "runs"
  experiment_name: "stochastic_coteaching_test"
  log_interval: 100
  
  early_stopping:
    enabled: true
    monitor: "fnr"                      # Monitor False Negative Rate
    mode: "min"                         # Minimize FNR
    patience: 80
    min_delta: 0.001
    
  model_params:
    input_shape: [30, 30, 1]
    num_classes: 2
    num_conv_blocks: 4
    filters_1: 16
    filters_2: 64
    filters_3: 96
    filters_4: 384
    dropout_1: 0.25
    dropout_2: 0.25
    dropout_3: 0.5
    units: 256

random_state: 42
